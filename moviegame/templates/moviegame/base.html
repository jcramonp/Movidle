{% load static %}
{% load i18n %}
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Movidle{% endblock %}</title>
  <link rel="stylesheet" href="{% static 'moviegame/app.css' %}">
  {% block head %}{% endblock %}
</head>
<body class="bg">
  <header class="site-header">
  {% if navbar_mode == 'admin' %}
    <!-- Navbar reducida para el panel -->
    <div class="nav-shell">
      <a class="brand-left" href="{% url 'moviegame:admin_dashboard' %}">movidle</a>
      <nav class="nav-center">
        <div class="nav-pill">
          <a class="nav-link" href="{% url 'moviegame:admin_dashboard' %}">{% trans "Panel" %}</a>
          <form action="{% url 'moviegame:logout' %}" method="post">
            {% csrf_token %}<button class="nav-link as-link" type="submit">{% trans "Salir" %}</button>
          </form>
        </div>
      </nav>
      <div class="lang-right">
        <form action="{% url 'set_language' %}" method="post">
          {% csrf_token %}<input type="hidden" name="next" value="{{ request.get_full_path }}">
          {% get_current_language as LANGUAGE_CODE %}
          <button name="language" value="es" class="lang-link {% if LANGUAGE_CODE|slice:":2" == 'es' %}is-active{% endif %}">ES</button>
          <span class="lang-sep">|</span>
          <button name="language" value="en" class="lang-link {% if LANGUAGE_CODE|slice:":2" == 'en' %}is-active{% endif %}">EN</button>
        </form>
      </div>
    </div>
  {% else %}
    <!-- Navbar pública -->
    <div class="nav-shell">
      <a class="brand-left" href="{% url 'moviegame:home' %}">movidle</a>

      <nav class="nav-center" role="navigation" aria-label="Primary">
        <div class="nav-pill">
          <a class="nav-link" href="{% url 'moviegame:howto' %}">{% trans "Cómo jugar" %}</a>
          <a class="nav-link" href="{% url 'moviegame:api_info' %}">API</a>
          <a class="nav-link" href="{% url 'moviegame:productos_aliados' %}">{% trans "Aliados" %}</a>

          {% if user.is_authenticated %}
            <a class="nav-link" href="{% url 'moviegame:stats' %}">{% trans "Estadísticas" %}</a>
            <form action="{% url 'moviegame:logout' %}" method="post">
              {% csrf_token %}<button class="nav-link as-link" type="submit">{% trans "Salir" %}</button>
            </form>
          {% else %}
            <a class="nav-link" href="{% url 'moviegame:login' %}">{% trans "Entrar" %}</a>
            <a class="nav-link" href="{% url 'moviegame:register' %}">{% trans "Registro" %}</a>
          {% endif %}
        </div>
      </nav>

      <!-- Idiomas a la derecha: ES | EN -->
      <div class="lang-right">
        <form action="{% url 'set_language' %}" method="post">
          {% csrf_token %}<input type="hidden" name="next" value="{{ request.get_full_path }}">
          {% get_current_language as LANGUAGE_CODE %}
          <button name="language" value="es" class="lang-link {% if LANGUAGE_CODE|slice:":2" == 'es' %}is-active{% endif %}">ES</button>
          <span class="lang-sep">|</span>
          <button name="language" value="en" class="lang-link {% if LANGUAGE_CODE|slice:":2" == 'en' %}is-active{% endif %}">EN</button>
        </form>
      </div>
    </div>
  {% endif %}
</header>


  <main class="container">
    {% block content %}{% endblock %}
  </main>
</body>
</html>
